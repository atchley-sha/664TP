# Projected Traffic

{{< include ../setup.qmd >}}

Part of this analysis involves determining the number of trips that are expected to visit the site. This includes trips made with the express purpose of visiting a location in the development, as well as "pass-by" trips where the ultimate destination is somewhere else. Each of the separate land uses has distinct baseline trip rates, as well as different parameters for adjusting these rates to obtain final projected trips.

## Trip Generation

\acr{ITE} provides several resources for estimating trip generation of new developments. The primary of these is the Trip Generation Manual [@instituteoftransportationengineers2021], but these baseline trip generation rates do not account for trips internal to the site, or for "pass-by" trips. The following section discusses the baseline \acr{ITE}-provided trip rates along with the trip reductions due to these factors. @tbl-tripgen-passby provides the trip rates after the reductions.

### Base Trip Generation

The initial estimates for trip generation are given from the \acr{ITE} Trip Generation Manual. For this report, only an analysis of the weekday PM peak period is performed, due to the scope of the assignment. @tbl-base-tripgen gives the baseline trip generation as provided by the Manual. These initial estimates seem reasonable, noting that these are the trips in the peak hour. See @sec-apdx-tripgen for the Manual references used in these calculations.

```{r}
#| label: tbl-base-tripgen
#| tbl-cap: "ITE Trip Generation (Baseline)"

tar_read(tripgen) %>% 
  select(-(mu_enter:last_col())) %>% 
  flextable() %>% 
  colformat_md(j = "xvar") %>% 
  mk_par(j = "eqn", value = as_paragraph(as_equation(.)), use_dot = TRUE) %>% 
  set_header_labels(desc = "Description", pad = "Pad", code = "ITE Land\nUse Code", xval = "Variable\nValue", xvar = "Variable\nUnit", eqn = "Trip Generation\nEquation", trips_enter = "Entering\nTrips", trips_exit = "Exiting\nTrips", trips_tot = "Total\nTrips") %>% 
  autofit() %>% 
  align(align = "c", part = "a")
```

### Multi-use Reduction

Since these land uses share a development site, a multi-use trip reduction may be applied. This accounts for trips that are made from one location in the development site to another, and thus do not use the adjacent roadways. Information on the multi-use capture rates was obtained from the \acr{ITE} Trip Generation Handbook [@instituteoftransportationengineers2014], and the relevant information is summarized in @tbl-ite-multi-use-rates. The reduced trip rates are given in @tbl-tripgen-multiuse, and @sec-apdx-tripgen contains more detailed calculations.

```{r}
#| label: tbl-ite-multi-use-rates
#| tbl-cap: "ITE Multi-use Capture Rates"

tribble(
  ~trips, ~rate,
  "From Office to Retail", "23%",
  "From Retail to Office", "3%",
  "To Office from Retail", "31%",
  "To Retail from Office", "2%"
) %>% 
  flextable() %>% 
  set_header_labels(trips = "Trip Movement", rate = "Capture Rate") %>% 
  autofit() %>% 
  align(align = "c", part = "a")
```

```{r}
#| label: tbl-tripgen-multiuse
#| tbl-cap: "Trips After Multi-use Reduction"

tar_read(tripgen) %>% 
  select(desc, code, mu_enter, mu_exit, mu_tot) %>% 
  flextable() %>% 
  set_header_labels(desc = "Description", code = "ITE Land\nUse Code", mu_enter = "Entering\nTrips", mu_exit = "Exiting\nTrips", mu_tot = "Total\nTrips") %>% 
  autofit() %>% 
  align(align = "c", part = "a")
```

### Pass-by Reduction

The \acr{ITE} Trip Generation Manual also provides information on pass-by trip reductions. These indicate trips that otherwise would have passed the development, and are "stopping by" the site rather than making a dedicated "new" trip to the site. Two of the proposed land uses---the restaurant and the hardware store---are given pass-by reduction rates of 43% and 26%, respectively. The office land use has no pass-by reduction, which is logical as most office trips would be for employment and not leisure. @tbl-tripgen-passby presents the new calculated trips after these reductions.

```{r}
#| label: tbl-tripgen-passby
#| tbl-cap: "Pass-By Trips"

tar_read(tripgen) %>% 
  select(desc, code, pb_rate, pb_enter, pb_exit, pb_tot) %>% 
  flextable() %>% 
  set_header_labels(desc = "Description", code = "ITE Land\nUse Code", pb_rate = "Pass-by\nReduction Rate", pb_enter = "Entering\nTrips", pb_exit = "Exiting\nTrips", pb_tot = "Total\nTrips") %>% 
  autofit() %>% 
  align(align = "c", part = "a")
```

## Modal Split

This analysis will be done in full in the future, but a mode split reduction of 1% is assumed. This will be used to calculate trip numbers for trip assignment on new trips, but not pass-by trips as those are assumed (almost by definition) to all be vehicular.

## Trip Distribution

This section presents two methods for determining 

### Analogy Method {#sec-analogy-method}



### Gravity Method {#sec-gravity-method}

The gravity method uses a modified gravity model to determine trip distribution. This model estimates the proportion of trips from each \acr{TAZ} in the vicinity of the study area based on the population of each \acr{TAZ} and the travel time from each \acr{TAZ} to the site. The model is of the form

$$
PT_i = \frac{A_i \times \frac{1}{tt_i^2}}{\sum{A_i \times \frac{1}{tt_i^2}}},
$$

where $PT_i$ is the proportion of trips from \acr{TAZ} $i$, $A_i$ is the population of \acr{TAZ} $i$, and $tt_i$ is the travel time to the site from \acr{TAZ} $i$. Note that this differs from a typical gravity model in two main ways: we are calculating a *proportion* of trips since all trips are going to the same \acr{TAZ}, and population, which is typically used in determining \acr{TAZ} trip productions, is instead used as a trip attraction value.

It is not reasonable to analyze every \acr{TAZ} in Utah, and so a maximum travel time of `r tar_read time_threshold` minutes is enforced. Based on the land uses of the site and the proximity of similar/competing land uses, this threshold provides a good estimate of the travel behavior. Though there are other residential, retail, and office land uses within a smaller travel window than this, the retail is specific, and the office will attract its employees with little regard for other nearby offices.

For reference, @fig-isochrone shows travel time contours from the site for 10-, 15-, and 20-minute thresholds to each \acr{TAZ}. Note that there are several \acr{TAZ}s "missing": these had a travel time of 0 and so were removed from the analysis.

```{r}
#| label: fig-isochrone
#| fig-cap: "Isochrone map of travel times to the study site (in dark blue)."
#| fig-width: 6.5
#| fig-height: 10

tar_read(isochrone_map)
```

@fig-access-dir shows the site access direction for each \acr{TAZ}. Several assumptions were made in this regard. The most significant of these is who accesses the site via I-15 north of Provo. This analysis assumes that west of Orem State Street (500W) and north of University Parkway, I-15 would be used, and east of Orem State Street and/or south of University Parkway, a combination of University Parkway, University Avenue, and Orem Center Street would be used to access the site from the north. North of Orem 800 N is assumed to have access via I-15 as well. Note that I-15 has an interchange directly south of the site on University Avenue, so it is assumed everyone using I-15 will access the site from the south. There are a handful of \acr{TAZ}s on the west of the site that are assumed to have western access due to I-15 under- and overpasses, but no access from the east is assumed due to the presence of the railroad.

```{r}
#| label: fig-access-dir
#| fig-cap: "Access to site (in dark blue) by direction."
#| fig-width: 6.5
#| fig-height: 10

tar_read(taz_access_map)
```

Combining this model with the information about access direction gives a proportion of trips from each direction. @tbl-trip-proportions presents a summary of this information. Note that this distribution is only for "new" trips; the distribution of pass-by trips is the same as in @sec-analogy-method (see @fig-analogy-distribution).

```{r}
#| label: tbl-trip-proportions
#| tbl-cap: "Proportion of Trips by Access Direction (Gravity Model)"

tar_read(grav_time) %>% 
  select(-trip_prop) %>% 
  flextable() %>% 
  set_header_labels(access_dir = "Access\nDirection", n_taz = "Number\nof \acr{TAZ}s", trip_pct = "Proportion\nof Trips") %>% 
  autofit() %>% 
  align(align = "c", part = "a")

```

### Method Comparison



## Trip Assignment

### Non-site Traffic